
# 📈 S1. 주식 종목 등록 및 실시간 수익률 계산

> 사용자가 본인이 보유한 주식 종목을 등록하고, 실시간으로 수익률과 평가액을 확인하는 흐름입니다.  
> 외부 API를 통해 실시간 시세 데이터를 받아 계산하며, 사용자 자산 정보와 통합하여 제공됩니다.

---

## 🎯 유즈케이스 목적

- 사용자는 자신이 보유한 주식 종목 정보를 입력할 수 있다.
- 시스템은 실시간 시세를 외부 API로부터 조회하여 평가금액과 수익률을 계산한다.
- 계산된 정보는 자산 대시보드 또는 주식 상세 페이지에 표시된다.

---

## 👥 참여 객체

| 객체 | 설명 |
|------|------|
| User | 주식을 등록하고 수익률을 조회하는 사용자 |
| React 주식 등록/상세 뷰 | 주식 종목 입력 UI 및 시세 표시 컴포넌트 |
| Django API (/api/stocks/) | 종목 등록 및 시세 계산 요청 |
| StockService | 등록/계산 처리 담당 서비스 |
| External Stock API (Mock or 실 API) | 실시간 시세 제공 |
| PostgreSQL (Stocks) | 사용자 보유 주식 정보 저장소 |

---

## 🔄 시나리오 흐름

### [1] 종목 등록

1. 사용자가 종목명, 수량, 매입단가 등을 입력한다.
2. React는 `POST /api/stocks/` 요청을 전송한다.
3. Django API에서 입력 값을 검증한 후 StockService에 전달
4. StockService는 DB에 주식 정보를 저장한다.
5. 저장 완료 후 응답을 반환한다.

### [2] 실시간 수익률 계산

1. React는 `GET /api/stocks/summary` 요청을 주기적으로 수행한다.
2. Django API는 사용자 보유 종목 리스트를 조회한다.
3. 각 종목에 대해 외부 시세 API 요청을 보낸다.
4. 응답받은 현재가를 기준으로 수익률, 평가금액을 계산
5. 계산 결과를 JSON으로 응답
6. React는 계산값을 UI에 표시한다.

---

## 📌 예외 흐름

- 외부 API 요청 실패 → “시세 조회 실패” 메시지 표시
- 종목명이 잘못된 경우 등록 거부
- 비로그인 상태에서는 접근 불가

---

## 🔗 관련 API 명세 (간략)

### 1. 주식 등록

```
POST /api/stocks/

요청:
{
  "symbol": "005930",
  "name": "삼성전자",
  "quantity": 10,
  "buy_price": 64000
}
```

### 2. 수익률 계산

```
GET /api/stocks/summary

응답:
[
  {
    "symbol": "005930",
    "name": "삼성전자",
    "quantity": 10,
    "buy_price": 64000,
    "current_price": 67000,
    "return_rate": 4.69,
    "return_amount": 3000
  },
  ...
]
```

---

## ✅ 기대 효과

- 주식 자산 상태를 실시간으로 확인 가능
- 전체 자산 흐름과 통합된 포트폴리오 관리에 유용
