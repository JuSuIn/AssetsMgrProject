
# 🔄 A1. 외부 금융기관 자산 통합 연동 (마이데이터 유사 시나리오)

> **목표**: 사용자가 외부 금융기관(은행, 증권사 등)의 자산 데이터를 연동하여 본인의 대시보드에 통합 자산 정보로 반영할 수 있도록 한다.  
※ 본 구현은 포트폴리오 기반으로 실제 OpenBanking API가 아닌 Mock 흐름 및 시나리오를 기반으로 합니다.

---

## 📅 문서 작성일
- 2025-06-19

---

## 🎯 유즈케이스 설명

- 사용자는 외부 기관과의 연동을 통해 자동으로 자산 데이터를 불러올 수 있다.
- 최초 1회 인증이 필요하며, 이후 토큰 기반으로 수동/자동 동기화가 가능하다.
- 연동된 자산은 내부 DB에 정제되어 저장되고, 자산 대시보드에 실시간 반영된다.

---

## 👥 액터

| 액터 | 설명 |
|------|------|
| 사용자 (User) | 외부 금융 데이터를 연동하는 주체 |
| 시스템 (WebApp, Django API) | 연동 요청 및 데이터 처리 담당 |
| 외부 금융기관 (Mock API) | 자산 데이터를 제공하는 외부 주체 |
| Celery Worker | 비동기 수집 처리 담당 |

---

## 📌 시나리오 흐름 요약

1. 사용자가 '자산 연동하기' 버튼 클릭
2. Mock 인증 페이지로 이동 (OAuth 흉내)
3. 사용자는 가짜 로그인 후 '동의' → 액세스 토큰 발급
4. WebApp은 Django API에 토큰 전달
5. Django는 Celery에 수집 요청 큐잉
6. Celery는 외부 금융기관(Mock API or JSON)에서 자산 조회
7. 정제된 데이터를 DB에 저장
8. 완료 알림 생성 → 사용자에게 노출

---

## 🔗 관련 API 명세

| Endpoint | Method | 설명 |
|----------|--------|------|
| `/auth/mock-login` | GET | OAuth 인증 UI 시뮬레이션 |
| `/api/mydata/token` | POST | OAuth 토큰 수신 및 저장 |
| `/api/mydata/import` | POST | 연동 요청, Celery 작업 생성 |
| `/api/assets/` | GET | 최종 반영된 자산 데이터 조회 |

---

## 💡 구현 포인트

- 실제 API 대신 `Mock JSON API` 또는 local JSON 파일 사용
- 토큰은 UUID 형태로 가짜 발급
- Celery worker는 임의 시간 지연 후 결과 생성
- 사용자 자산 데이터는 `user_id`에 연동되어 저장

---

## ✅ 기대 결과

- 마이데이터와 유사한 인증 + 수집 + 통합 저장 흐름 설계 능력 입증
- Celery + MockAPI를 활용한 비동기 처리 경험 강조
- 실무에서의 외부 시스템 통합 설계 가능성 어필
